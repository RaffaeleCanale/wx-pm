function install() {
    info "npm install"
    npm install
    if hasBuildScript; then
        info "npm run build"
        npm run build
    fi

    addPathScript
}

function addPathScript() {
    local name=`cat package.json | jq -r '.name'`
    if [ "$name" == "null" ]; then
        name=`basename "$PWD"`
    fi
    local main=`cat package.json | jq -r '.main'`
    main="$PWD/$main"

    local output="$WX_PATH/$name"
    echo "node \"$main\" \"\$@\"" > "$output"
    chmod +x "$output"
    info "Create start script at $output"
}

function hasBuildScript() {
    local script=`cat package.json | jq -r '.scripts.build'`
    [ "$script" != "null" ]
}
